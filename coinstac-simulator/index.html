<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Home - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="Get%2520an%2520object%2520that%2520behaves%2520like%2520%2560ComputationRegistry%2560%2520but%2520contains%2520a%2520stubbed%250Acomputation%2520via%2520the%2520%2560computationPath%2560%2520paramter.module_.html">Get an object that behaves like `ComputationRegistry` but contains a stubbed
computation via the `computationPath` paramter.</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-simulator.html">simulator</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-src_boot-locals.html">src/boot-locals</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#createUserData">createUserData</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#formatter">formatter</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getChildProcessLogger">getChildProcessLogger</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getReadyLocalProcess">getReadyLocalProcess</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#getStdDataHandler">getStdDataHandler</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#loadFiles">loadFiles</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#run">run</a></span></li>
</nav>

<div id="main">
    

    



    









    


    <section class="readme">
        <article><h1>coinstac-simulator</h1><p><img src="https://raw.githubusercontent.com/MRN-Code/coinstac/master/img/coinstac.png" height="75px"></p>
<p>COINSTAC simulator for computation runs. <a href="http://mrn-code.github.io/coinstac/">Documentation</a>.</p>
<p><img src="https://raw.githubusercontent.com/MRN-Code/coinstac/master/packages/coinstac-simulator/media/demo-capture.gif" /></p>
<h2>Installation</h2><p>Ensure you have <a href="https://nodejs.org/">Node.js</a> installed. Then, the following command from a shell:</p>
<pre class="prettyprint source lang-shell"><code>npm install --global coinstac-simulator</code></pre><h2>Use</h2><p><em>coinstac-simulator</em> contains a command line interface and a Node.js API. Read the <a href="https://github.com/MRN-Code/coinstac/blob/master/guides/computation-development.md"><em>Computation Development</em> guide</a> for more information on creating decentralized computations and testing them with <em>coinstac-simulator</em>.</p>
<h3>CLI</h3><p><em>coinstac-simulator</em> has one required flag, <code>--declaration</code> (<code>-d</code> for short). Use it to designate the location of your declaration file:</p>
<pre class="prettyprint source lang-shell"><code>coinstac-simulator -d ./path/to/declaration.js</code></pre><p>Run <code>coinstac-simulator --help</code> for more information on how to use the CLI.</p>
<h3>Programmatic Use</h3><p>Ensure that a valid <em>package.json</em> exists in your project’s directory (easily create one with <code>npm init</code>). Then, add <em>coinstac-simulator</em> as a dependency:</p>
<pre class="prettyprint source lang-shell"><code>npm install coinstac-simulator --save</code></pre><p><em>coinstac-simulator</em> is now available in your JavaScript modules. Include it using <code>require</code>:</p>
<pre class="prettyprint source lang-js"><code>// declaration.js
const coinstacSimulator = require('coinstac-simulator');</code></pre><h4>coinstacSimulator.createUserData(pattern, [csvPath], [delimiter])</h4><ul>
<li><strong><code>pattern</code></strong> <code>&lt;String&gt;</code>: File globbing pattern passed to <a href="https://www.npmjs.com/package/glob">glob</a></li>
<li><strong><code>csvPath</code></strong> <code>&lt;String&gt;</code>: Path to a CSV variables file to load</li>
<li><strong><code>delimiter</code></strong> <code>&lt;String&gt;</code>: CSV delimiter</li>
<li>return: <code>&lt;Array&gt;</code> Collection of user data</li>
</ul>
<p>Synchronously transpose a directory structure into user data suitable for simulation. This method supports a particular directory structure:</p>
<pre class="prettyprint source lang-shell"><code>$ tree path/to/data/
path/to/data/
├── user-1
│   └── x
│   │   ├── data-1.txt
│   │   └── data-2.txt
│   └── y
│       ├── data-3.txt
│       └── data-4.txt
└── user-2
  └── x
  │   ├── data-5.txt
  │   └── data-6.txt
  └── y
      ├── data-7.txt
      └── data-8.txt</code></pre><p>Top-level directories are treated as users; their immediate subdirectories are treated as variable names. The subdirectories’ files’ data are loading into these properties, like so:</p>
<pre class="prettyprint source lang-js"><code>[
  // user-1:
  {
    x: [
      // data-1.txt, data-2.txt
    ],
    y: [
      // data-3.txt, data-4.txt
    ],
  },

  // user-2:
  {
    x: [
      // data-5.txt, data-6.txt
    ],
    y: [
      // data-7.txt, data-8.txt
    ],
  },
]</code></pre><p>Adding a supporting CSV via the <code>csvPath</code> argument aids in parsing files:</p>
<pre class="prettyprint source lang-csv"><code>user,t,u,v
user-1,1,2,2
user-2,4,5,6</code></pre><p><code>createUserData</code> is most useful in a declaration file:</p>
<pre class="prettyprint source lang-js"><code>const coinstacSimulator = require('coinstac-simulator');

module.exports = {
  computationPath: './path/to/computation.js',
  local: coinstacSimulator.createUserData(
    './path/to/data/**/*.txt',
    './path/to/vars.csv'
  ),
};</code></pre><h4>coinstacSimulator.loadFiles(pattern, [delimiter]):</h4><ul>
<li><strong><code>pattern</code></strong> <code>&lt;String&gt;</code>: File globbing pattern passed to <a href="https://www.npmjs.com/package/glob">glob</a></li>
<li><strong><code>delimiter</code></strong> <code>&lt;String&gt;</code>: CSV delimiter</li>
<li>return: <code>&lt;Array&gt;</code> Parsed input data</li>
</ul>
<p>Synchronously loads files' data. <code>loadFiles</code> is most useful in a declaration file:</p>
<pre class="prettyprint source lang-js"><code>// declaration.js
const coinstacSimulator = require('coinstac-simulator');

module.exports = {
  computationPath: './path/to/computation.js',
  local: [
    {
      x: coinstacSimulator.loadFiles('./path/to/files/1/*.txt'),
    },
    {
      x: coinstacSimulator.loadFiles('./path/to/files/2/*.txt'),
    }, {
      x: coinstacSimulator.loadFiles('./path/to/files/3/*.txt'),
    },
  ],
};</code></pre><h4>coinstacSimulator.run(declarationPath)</h4><ul>
<li><strong><code>declarationPath</code></strong> <code>&lt;String&gt;</code>: Path to declaration file</li>
<li>return: <code>&lt;Promise&gt;</code> Resolves upon simulator run completion, or rejects with a run error</li>
</ul>
<p><code>run</code> is <em>coinstac-simulator</em>’s programmatic function for running an entire simulation. Use it if you don’t want to use the CLI:</p>
<pre class="prettyprint source lang-js"><code>const coinstacSimulator = require('coinstac-simulator');

coinstacSimulator.run('./path/to/declaration.js')
  .then(() => console.log('Simulation run complete!'))
  .catch(error => console.error('Simulation run failed!', error));</code></pre><h2>Debugging</h2><p>Set the <code>verbose</code> property in your declaration to <code>true</code>:</p>
<pre class="prettyprint source lang-js"><code>// declaration.js
module.exports = {
  computationPath:
  local: [
    // ...
  ],
  verbose: true,
};</code></pre><p>This ensures that all <code>console.log</code>s in your JavaScript computations and stdout/stderr writes in your command computations will persist to the main process’s logger and your terminal.</p>
<p>View the <a href="https://github.com/MRN-Code/coinstac/blob/master/guides/computation-development.md"><em>Computation Development</em> guide</a> for more information on computations in COINSTAC.</p>
<h2>License</h2><p>MIT. See <a href="./LICENSE">LICENSE</a> for details.</p></article>
    </section>






</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>